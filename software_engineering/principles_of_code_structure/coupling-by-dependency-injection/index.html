<!DOCTYPE html>
<html lang="en">

  <head>
    <title>Coupling By Dependency Injection | Explicator</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="/../../essay.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet"> 
  </head>
  
  <body>
  
    
    

    <header style="background: steelblue">
      <h1 class="title">Coupling By Dependency Injection</h1>
      <p class="subtitle"><strong>2023-04-16</strong></p>
    </header>

    <nav>
      <h3 style="text-align: center;">Navigation Links</h3>
    
      
      <p><a style="padding-left: 1em;" href="https://natlund.github.io/">Home Page</a></p>

      
        
        <p><a style="padding-left: 2em;" href="https://natlund.github.io/software_engineering/">Software Engineering</a></p>
      
        
        <p><a style="padding-left: 3em;" href="https://natlund.github.io/software_engineering/principles_of_code_structure/">Principles Of Code Structure</a></p>
      
            
      <hr>
      
      <p><a style="padding-left: 1em;" href="https://natlund.github.io/software_engineering/principles_of_code_structure/">Principles Of Code Structure</a></p>

      <ol>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/readability/">Readability</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/elementary-code-structures/">Elementary Code Structures</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/art-of-abstraction/">The Art Of Abstraction</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/platinum-rule-of-thumb/">The Platinum Rule Of Thumb</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/separation-of-concerns/">Separation Of Concerns</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/single-source-of-truth/">Single Source Of Truth</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/separate-inherent-and-collateral-complexity/">Separate Inherent And Collateral Complexity</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/separation-of-functions-and-state/">Separation Of Functions And State</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/distinguish-algorithmlike-from-datalike-code/">Distinguish Algorithm-like From Data-like Code</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/separate-input-output-from-computation/">Separate Input&#x2F;Output From Computation</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/separate-business-logic-from-mechanical-work/">Separate Business Logic From Mechanical Work</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/collate-the-concern-of-logical-branching/">Collate The Concern Of Logical Branching</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling/">Coupling</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/taxonomy-of-connections/">Taxonomy Of Connections</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-by-direct-connection/">Coupling By Direct Connection</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-by-dependency-injection/">Coupling By Dependency Injection</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-by-inheritance/">Coupling By Inheritance</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-summary/">Coupling Summary</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-modules-into-a-structure/">Coupling Modules Into A Structure</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/make-execution-flow-obvious/">Make Execution Flow Obvious</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/data-flow-should-follow-execution-flow/">Data Flow Should Follow Execution Flow</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/interfaces/">Interfaces - The Glue That Connects</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/miscellaneous-advice/">Miscellaneous Advice</a>
          </li>
        
          <li>
            <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/thinking-like-an-engineer/">Thinking Like An Engineer</a>
          </li>
        
      </ol>
      
      <hr>

      <p style="padding-left: 1em;">Coupling By Dependency Injection</p>
    
        
        <ul>
        
            <li>
                <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-by-dependency-injection/#function-call-of-injected-function">Function Call Of Injected Function</a>
                
                    <ul>
                        
                            <li>
                                <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-by-dependency-injection/#simplicity">Simplicity:</a>
                            </li>
                        
                            <li>
                                <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-by-dependency-injection/#replaceability">Replaceability:</a>
                            </li>
                        
                    </ul>
                
            </li>
        
            <li>
                <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-by-dependency-injection/#method-call-on-injected-object">Method Call On Injected Object</a>
                
                    <ul>
                        
                            <li>
                                <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-by-dependency-injection/#simplicity-1">Simplicity:</a>
                            </li>
                        
                            <li>
                                <a href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-by-dependency-injection/#replaceability-1">Replaceability:</a>
                            </li>
                        
                    </ul>
                
            </li>
        
        </ul>
        
    </nav>

    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
           
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    
        
          

    

    <div class="previous_next_header">
        <p>
        
            <a style="float: left;" href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-by-direct-connection/">Previous: Coupling By Direct Connection</a>
        

        
            <a style="float: right;" href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-by-inheritance/">Next: Coupling By Inheritance</a>
        
       </p>
    </div>

    <article class="essay">
        <h1 id="function-call-of-injected-function">Function Call Of Injected Function</h1>
<pre data-lang="py" style="background-color:#2b303b;color:#c0c5ce;" class="language-py "><code class="language-py" data-lang="py"><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">secondary</span><span>(</span><span style="color:#bf616a;">data</span><span>):
</span><span>    </span><span style="color:#65737e;"># Do stuff.
</span><span>
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">main</span><span>(</span><span style="color:#bf616a;">injected_func</span><span>):
</span><span>    </span><span style="color:#d08770;">...
</span><span>    </span><span style="color:#bf616a;">injected_func</span><span>(data)
</span><span>    </span><span style="color:#d08770;">...
</span><span>
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">orchestrator</span><span>():
</span><span>    </span><span style="color:#d08770;">...
</span><span>    </span><span style="color:#bf616a;">main</span><span>(</span><span style="color:#bf616a;">injected_func</span><span>=secondary)
</span><span>
</span></code></pre>
<h3 id="simplicity">Simplicity:</h3>
<p>No longer simple.  There are now <em>three</em> modules required.  However, each module is itself very simple.</p>
<p>The coupling consists of two elements: the Orchestrator passing Function B into Module A, and the call on Function B.  Worryingly, the two elements of coupling are <em>necessarily</em> in different parts of the code.</p>
<p>The function call has been <strong>anonymised</strong>:  When reading the <code>main()</code> function alone, it is impossible to know what <em>real</em> function the injected function actually is.  (In fact, An IDE would probably be unable to 'jump to source' of <code>injected_func</code>.)  We may say that the connection is <strong>indirect</strong> or abstract.</p>
<p>In order to fully understand the coupling, the reader needs to follow a function as it is passed around the code.  The complexity of indirect connection is a mental load on the reader.</p>
<div align="center">
<svg width="500" height="190">
    <defs>
        <marker
            id="arrowhead"
            markerWidth="3" markerHeight="3" 
            refX="2" refY="1.5"
            orient="auto"
        >
            <polygon points="1 1.5, 0 3, 3 1.5, 0 0" />
        </marker>
    </defs>
    <rect x="5"   y="5" width="410" height="60" rx="15" stroke="black" fill="gainsboro" />
    <text x="210" y="35" text-anchor="middle" alignment-baseline="central">Orchestrator</text>
    <rect x="5"   y="125" width="160" height="60" rx="15" stroke="black" fill="lime" />
    <text x="85" y="155" text-anchor="middle" alignment-baseline="central">Module A</text>
    <rect x="255" y="125" width="160" height="60" rx="15" stroke="black" fill="cyan" />
    <text x="335" y="155" text-anchor="middle" alignment-baseline="central">Function B</text>
    <line x1="335" y1="125" x2="335" y2="65" stroke="gray" stroke-width="6" />
    <line x1="338" y1="65" x2="82" y2="65" stroke="gray" stroke-width="6" />
    <line x1="85" y1="65" x2="85" y2="125" stroke="gray" stroke-width="6" marker-end="url(#arrowhead)"/>
    <line x1="165" y1="155" x2="252" y2="155" stroke="black" stroke-width="6" stroke-dasharray="15 5" marker-end="url(#arrowhead)"/>
</svg>
</div>
<h3 id="replaceability">Replaceability:</h3>
<p>The defining attribute of this form of coupling is that the <code>main()</code> function <em>does not need to be touched</em> to change functionality.</p>
<p>However, the <em>orchestrator</em> function will need to be changed, to pass in the new function.</p>
<pre data-lang="py" style="background-color:#2b303b;color:#c0c5ce;" class="language-py "><code class="language-py" data-lang="py"><span style="color:#65737e;"># def secondary(data):
</span><span style="color:#65737e;">#    # Do stuff.
</span><span>
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">alternative</span><span>(</span><span style="color:#bf616a;">data</span><span>):
</span><span>    </span><span style="color:#65737e;"># Do stuff better.
</span><span>
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">main</span><span>(</span><span style="color:#bf616a;">injected_func</span><span>):
</span><span>    </span><span style="color:#d08770;">...
</span><span>    </span><span style="color:#bf616a;">injected_func</span><span>(data)
</span><span>    </span><span style="color:#d08770;">...
</span><span>
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">orchestrator</span><span>():
</span><span>    </span><span style="color:#d08770;">...
</span><span>    </span><span style="color:#65737e;"># main(injected_func=secondary)
</span><span>    </span><span style="color:#bf616a;">main</span><span>(</span><span style="color:#bf616a;">injected_func</span><span>=alternative)
</span><span>
</span></code></pre>
<ul>
<li>Write new replacement function.</li>
<li>One-line change in orchestrator function, to pass in alternative function.</li>
<li><code>main()</code> function is <strong>not</strong> changed.</li>
</ul>
<h1 id="method-call-on-injected-object">Method Call On Injected Object</h1>
<pre data-lang="py" style="background-color:#2b303b;color:#c0c5ce;" class="language-py "><code class="language-py" data-lang="py"><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">SomeStupidClass</span><span style="color:#eff1f5;">:
</span><span>
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">secondary</span><span>(</span><span style="color:#bf616a;">self</span><span>, </span><span style="color:#bf616a;">data</span><span>):
</span><span>        </span><span style="color:#65737e;"># Do stuff.
</span><span>
</span><span>
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">main</span><span>(</span><span style="color:#bf616a;">injected_object</span><span>):
</span><span>    </span><span style="color:#d08770;">...
</span><span>    injected_object.</span><span style="color:#bf616a;">secondary</span><span>(data)
</span><span>    </span><span style="color:#d08770;">...
</span><span>
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">orchestrator</span><span>():
</span><span>    </span><span style="color:#d08770;">...
</span><span>    stupid_object = </span><span style="color:#bf616a;">SomeStupidClass</span><span>()
</span><span>    </span><span style="color:#bf616a;">main</span><span>(</span><span style="color:#bf616a;">injected_object</span><span>=stupid_object)
</span><span>
</span></code></pre>
<h3 id="simplicity-1">Simplicity:</h3>
<p>Relatively complex.  There are now <em>three</em> modules required.</p>
<p>The coupling consists of three elements:  the Orchestrator instantiating Object B, the Orchestrator passing Object B into Module A, and the call on Method C of Object B.<br />
Disturbingly, the method call is <em>necessarily</em> in a different part of the code from the other elements of the coupling.</p>
<p>Note that while the object is anonymous, the method call is on the actual named method on the class.</p>
<p>This coupling pattern can manifest in a range of different ways, from perfectly readable to horrendously obfuscated, depending on how the <em>type</em> (class) of the injected object is controlled.  Let's explore three of those ways.</p>
<h4 id="injected-object-has-single-fixed-class">Injected Object Has Single Fixed Class</h4>
<p>First, consider the case where the injected object is <em>always</em> an instance of a <em>single</em> class.  The object may vary in its particulars, but there is only one bit of code to look at.  This should not pose any great problems for readability.</p>
<h4 id="injected-object-of-unknown-class-but-with-well-defined-interface">Injected Object Of Unknown Class But With Well-Defined Interface</h4>
<p>Next, consider the case where the class of the injected object is unknown, but the method constitutes a <em>well-defined interface</em>, in the following sense: While the behaviour of the method necessarily changes depending on the class, the behaviour is always sufficiently well-constrained that the reader <em>does not</em> really need to know about the detailed differences between the methods of the different classes.  In other words, the method call can always be treated as a call to a 'black box', whose inner workings do not matter to the reader trying to understand the code of Module A.</p>
<p>The method polymorphism used in this case should not pose a great problem for readability, <em>as long as</em> the software design guarantees that the reader can always treat the method call as a call to a closed 'black box'.  In practice, it may be difficult to always achieve this.  If the reader <em>does</em> end up needing to know the details inside a method, then this interface could be considered a 'leaky abstraction', at least from the reader's point of view, because the information hidden inside the abstraction 'leaks out'.</p>
<h4 id="injected-object-of-unknown-class">Injected Object Of Unknown Class</h4>
<p>Finally, consider the case where the class of the injected object is unknown, and the reader simply <em>must</em> read the details inside the method in order comprehend the code.</p>
<p>The method call on the object is an indirect connection:  When reading the <code>main()</code> function alone, it is impossible to know the real class of the injected object.  (In fact, An IDE will probably not be able to 'go to source' of <code>injected_object</code>.)</p>
<p>In order to fully understand the coupling, the reader needs to follow an object as it is passed around the code.  The complexity of indirect connection is a mental load on the reader.</p>
<div align="center">
<svg width="500" height="255">
    <defs>
        <marker
            id="arrowhead"
            markerWidth="3" markerHeight="3" 
            refX="2" refY="1.5"
            orient="auto"
        >
            <polygon points="1 1.5, 0 3, 3 1.5, 0 0" />
        </marker>
    </defs>
    <rect x="5"   y="5" width="415" height="60" rx="15" stroke="black" fill="gainsboro" />
    <text x="210" y="35" text-anchor="middle" alignment-baseline="central">Orchestrator</text>
    <rect x="5"   y="185" width="160" height="60" rx="15" stroke="black" fill="lime" />
    <text x="85" y="215" text-anchor="middle" alignment-baseline="central">Module A</text>
    <rect x="250" y="125" width="170" height="125" rx="5" stroke="black" fill="thistle" />
    <text x="335" y="155" text-anchor="middle" alignment-baseline="central">Object B</text>
    <rect x="255" y="185" width="160" height="60" rx="15" stroke="black" fill="cyan" />
    <text x="335" y="215" text-anchor="middle" alignment-baseline="central">Method C</text>
    <line x1="364" y1="125" x2="364" y2="65" stroke="black" stroke-width="6" />
    <line x1="307" y1="125" x2="307" y2="65" stroke="gray" stroke-width="6" />
    <line x1="310" y1="65" x2="82" y2="65" stroke="gray" stroke-width="6" />
    <line x1="85" y1="65" x2="85" y2="185" stroke="gray" stroke-width="6" marker-end="url(#arrowhead)"/>
    <line x1="165" y1="215" x2="252" y2="215" stroke="black" stroke-width="6" stroke-dasharray="15 5" marker-end="url(#arrowhead)"/>
</svg>
</div>
<h3 id="replaceability-1">Replaceability:</h3>
<p>Could in principle depend on whether the new functionality needs a whole new class or just a new method on the existing class.  However, the whole point of the flexibility of the orchestrator pattern is to <em>easily inject a different object</em>, so that's what we'll consider here.</p>
<pre data-lang="py" style="background-color:#2b303b;color:#c0c5ce;" class="language-py "><code class="language-py" data-lang="py"><span style="color:#65737e;"># class SomeStupidClass:
</span><span style="color:#65737e;">#
</span><span style="color:#65737e;">#    def secondary(self, data):
</span><span style="color:#65737e;">#        # Do stuff.
</span><span>
</span><span>
</span><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">LessStupidClass</span><span style="color:#eff1f5;">:
</span><span>
</span><span>    </span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">secondary</span><span>(</span><span style="color:#bf616a;">self</span><span>, </span><span style="color:#bf616a;">data</span><span>):
</span><span>        </span><span style="color:#65737e;"># Do stuff better.
</span><span>
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">main</span><span>(</span><span style="color:#bf616a;">injected_object</span><span>):
</span><span>    </span><span style="color:#d08770;">...
</span><span>    injected_object.</span><span style="color:#bf616a;">secondary</span><span>(data)
</span><span>    </span><span style="color:#d08770;">...
</span><span>
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">orchestrator</span><span>():
</span><span>    </span><span style="color:#d08770;">...
</span><span>    </span><span style="color:#65737e;"># stupid_object = SomeStupidClass()
</span><span>    stupid_object = </span><span style="color:#bf616a;">LessStupidClass</span><span>()
</span><span>    </span><span style="color:#bf616a;">main</span><span>(</span><span style="color:#bf616a;">injected_object</span><span>=stupid_object)
</span><span>
</span></code></pre>
<ul>
<li>Write new replacement class with different method <em>of same name</em>.</li>
<li>One-line change in orchestrator function, to instantiate new class.</li>
<li><code>main()</code> function is <strong>not</strong> changed.</li>
</ul>

        
        <p style="text-align: center; font-size: 24pt;"> &#128608 </p>

    
    </article>

    <div class="previous_next_footer">
        <p>
        
            <a style="float: left;" href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-by-direct-connection/">Previous: Coupling By Direct Connection</a>
        

        
            <a style="float: right;" href="https://natlund.github.io/software_engineering/principles_of_code_structure/coupling-by-inheritance/">Next: Coupling By Inheritance</a>
        
       </p>
    </div>
    
    <div class="filler"></div>

    <footer>
      <p class="datestamp"><strong>2023-04-16</strong></p>
    </footer>
  
  </body>

</html>
